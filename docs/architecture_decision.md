# 量化交易系统架构决策会议纪要

**日期**: 2026-02-10  
**决策**: 采用混合架构（方案C）  
**参会**: analyst, researcher, decider(cc)

---

## 一、当前问题诊断

### 1.1 策略表现问题
| 指标 | 2020-2024回测 | 2024回测 | 2024模拟盘 |
|------|--------------|----------|------------|
| MACD策略收益 | +60.59% | **-12.98%** | -0.72% |
| 交易次数 | 87 | 7 | 1 |
| 胜率 | - | 28.6% | - |

**结论**: MACD策略在2024年震荡市表现不佳，需要AI增强

### 1.2 技术问题
- 模拟盘T+1日期bug（已发现）
- 回测引擎允许资金透支（无保证金检查）
- 策略单一，无组合管理

---

## 二、方案对比决策

### 方案A: 纯自研
| 优点 | 缺点 |
|------|------|
| 完全可控 | AI/ML能力弱 |
| 已适配A股规则 | 因子挖掘效率低 |

**决策**: ❌ 否决 - AI能力不足

### 方案B: Qlib全替换
| 优点 | 缺点 |
|------|------|
| AI能力最强 | A股规则需重写 |
| 模型丰富 | 改造成本高 |

**决策**: ❌ 否决 - 迁移成本过高，已投入的A股适配浪费

### 方案C: 混合架构 ✅ **选定**

```
Qlib(上层) → 自研(中层) → vn.py(底层)
   AI训练  →  A股执行  →  实盘接口
```

| 层级 | 工具 | 职责 | 理由 |
|------|------|------|------|
| 研究层 | **Qlib** | AI模型、因子挖掘、组合优化 | 算法最先进，弥补策略短板 |
| 策略层 | **自研** | A股规则、风控、策略执行 | 已验证，完全可控 |
| 执行层 | **vn.py** | 实盘交易、订单管理 | 国内最成熟 |

---

## 三、实施路线图

### Phase 1: Qlib接入（本周-下周）
- [ ] Day 1-2: 安装Qlib，跑通官方示例
- [ ] Day 3-4: 用茅台数据训练XGBoost模型
- [ ] Day 5-7: 将Qlib预测接入模拟盘，对比MACD

### Phase 2: 策略优化（第2-3周）
- [ ] 修复模拟盘T+1 bug
- [ ] 修复资金透支检查
- [ ] 多因子组合策略（MACD + Qlib信号）

### Phase 3: 实盘准备（第4周）
- [ ] 接入vn.py CTP接口
- [ ] SIMNOW模拟测试
- [ ] 小资金实盘（1万元）

### Phase 4: 生产运行（第5周起）
- [ ] 10-50万实盘
- [ ] 每日自动运行
- [ ] 监控告警

---

## 四、风险评估

| 风险 | 概率 | 影响 | 应对 |
|------|------|------|------|
| Qlib数据格式不兼容 | 中 | 高 | 编写数据转换适配器 |
| Qlib模型效果不佳 | 中 | 高 | 准备多个模型对比 |
| 实盘滑点超预期 | 中 | 中 | 小资金先行测试 |
| vn.py接口不稳定 | 低 | 高 | 准备备用券商接口 |

---

## 五、关键指标

### 模拟盘达标标准
- 夏普比率 > 0.5
- 最大回撤 < 30%
- 胜率 > 55%
- 连续运行 > 3个月

### 实盘启动标准
- 模拟盘达标
- Qlib信号有效性验证
- 风险管理系统完备

---

## 六、资源需求

| 资源 | 需求 |
|------|------|
| 开发时间 | 3-4周 |
| 测试资金 | 1-50万 |
| 计算资源 | GPU（模型训练） |
| 数据费用 | AKShare免费 / Wind付费 |

---

**决策确认**: 采用混合架构，立即启动Phase 1

**下次评审**: 2026-02-17（一周后检查Qlib接入进展）
